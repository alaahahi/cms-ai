var Ce=Object.defineProperty;var He=(n,e,t)=>e in n?Ce(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var S=(n,e,t)=>(He(n,typeof e!="symbol"?e+"":e,t),t);const Ye=n=>Object.prototype.toString.call(n)==="[object Object]",fe=(n,e)=>{const t=document.createElement(n);if(e&&typeof e=="object")for(const s in e)s==="html"?t.innerHTML=e[s]:t.setAttribute(s,e[s]);return t},le=n=>["#text","#comment"].includes(n.nodeName)?n.data:n.childNodes?n.childNodes.map(e=>le(e)).join(""):"",ie=n=>{var e;if(n==null)return"";if(n.hasOwnProperty("text")||n.hasOwnProperty("data")){const t=n;return(e=t.text)!=null?e:ie(t.data)}return n.hasOwnProperty("nodeName")?le(n):String(n)},Me=function(n,e){let t=0,s=0;for(;t<n+1;)e[s].hidden||(t+=1),s+=1;return s-1},Oe=function(n){const e={};if(n)for(const t of n)e[t.name]=t.value;return e},ee=n=>n?n.trim().split(" ").map(e=>`.${e}`).join(""):null,me=(n,e)=>!(e==null?void 0:e.split(" ").some(s=>!n.classList.contains(s))),U=(n,e)=>n?e?`${n} ${e}`:n:e||"",Ie=function(n,e=300){let t;return(...s)=>{clearTimeout(t),t=window.setTimeout(()=>n(),e)}};var ve=function(){return ve=Object.assign||function(n){for(var e,t=arguments,s=1,i=arguments.length;s<i;s++)for(var o in e=t[s])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},ve.apply(this,arguments)};function de(n,e,t){if(t||arguments.length===2)for(var s,i=0,o=e.length;i<o;i++)!s&&i in e||(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return n.concat(s||Array.prototype.slice.call(e))}var C=function(){function n(e){e===void 0&&(e={});var t=this;Object.entries(e).forEach(function(s){var i=s[0],o=s[1];return t[i]=o})}return n.prototype.toString=function(){return JSON.stringify(this)},n.prototype.setValue=function(e,t){return this[e]=t,this},n}();function I(n){for(var e=arguments,t=[],s=1;s<arguments.length;s++)t[s-1]=e[s];return n!=null&&t.some(function(i){var o,a;return typeof((a=(o=n==null?void 0:n.ownerDocument)===null||o===void 0?void 0:o.defaultView)===null||a===void 0?void 0:a[i])=="function"&&n instanceof n.ownerDocument.defaultView[i]})}function ye(n,e,t){var s;return n.nodeName==="#text"?s=t.document.createTextNode(n.data):n.nodeName==="#comment"?s=t.document.createComment(n.data):(e?(s=t.document.createElementNS("http://www.w3.org/2000/svg",n.nodeName),n.nodeName==="foreignObject"&&(e=!1)):n.nodeName.toLowerCase()==="svg"?(s=t.document.createElementNS("http://www.w3.org/2000/svg","svg"),e=!0):s=t.document.createElement(n.nodeName),n.attributes&&Object.entries(n.attributes).forEach(function(i){var o=i[0],a=i[1];return s.setAttribute(o,a)}),n.childNodes&&n.childNodes.forEach(function(i){return s.appendChild(ye(i,e,t))}),t.valueDiffing&&(n.value&&I(s,"HTMLButtonElement","HTMLDataElement","HTMLInputElement","HTMLLIElement","HTMLMeterElement","HTMLOptionElement","HTMLProgressElement","HTMLParamElement")&&(s.value=n.value),n.checked&&I(s,"HTMLInputElement")&&(s.checked=n.checked),n.selected&&I(s,"HTMLOptionElement")&&(s.selected=n.selected))),s}var ge=function(n,e){for(e=e.slice();e.length>0;){var t=e.splice(0,1)[0];n=n.childNodes[t]}return n};function Q(n,e,t){var s,i,o,a=e[t._const.action],l=e[t._const.route];[t._const.addElement,t._const.addTextElement].includes(a)||(s=ge(n,l));var r={diff:e,node:s};if(t.preDiffApply(r))return!0;switch(a){case t._const.addAttribute:if(!s||!I(s,"Element"))return!1;s.setAttribute(e[t._const.name],e[t._const.value]);break;case t._const.modifyAttribute:if(!s||!I(s,"Element"))return!1;s.setAttribute(e[t._const.name],e[t._const.newValue]),I(s,"HTMLInputElement")&&e[t._const.name]==="value"&&(s.value=e[t._const.newValue]);break;case t._const.removeAttribute:if(!s||!I(s,"Element"))return!1;s.removeAttribute(e[t._const.name]);break;case t._const.modifyTextElement:if(!s||!I(s,"Text"))return!1;t.textDiff(s,s.data,e[t._const.oldValue],e[t._const.newValue]),I(s.parentNode,"HTMLTextAreaElement")&&(s.parentNode.value=e[t._const.newValue]);break;case t._const.modifyValue:if(!s||s.value===void 0)return!1;s.value=e[t._const.newValue];break;case t._const.modifyComment:if(!s||!I(s,"Comment"))return!1;t.textDiff(s,s.data,e[t._const.oldValue],e[t._const.newValue]);break;case t._const.modifyChecked:if(!s||s.checked===void 0)return!1;s.checked=e[t._const.newValue];break;case t._const.modifySelected:if(!s||s.selected===void 0)return!1;s.selected=e[t._const.newValue];break;case t._const.replaceElement:var c=e[t._const.newValue].nodeName.toLowerCase()==="svg"||s.parentNode.namespaceURI==="http://www.w3.org/2000/svg";s.parentNode.replaceChild(ye(e[t._const.newValue],c,t),s);break;case t._const.relocateGroup:de([],new Array(e[t._const.groupLength]),!0).map(function(){return s.removeChild(s.childNodes[e[t._const.from]])}).forEach(function(u,h){h===0&&(o=s.childNodes[e[t._const.to]]),s.insertBefore(u,o||null)});break;case t._const.removeElement:s.parentNode.removeChild(s);break;case t._const.addElement:var m=(p=l.slice()).splice(p.length-1,1)[0];if(!I(s=ge(n,p),"Element"))return!1;s.insertBefore(ye(e[t._const.element],s.namespaceURI==="http://www.w3.org/2000/svg",t),s.childNodes[m]||null);break;case t._const.removeTextElement:if(!s||s.nodeType!==3)return!1;var f=s.parentNode;f.removeChild(s),I(f,"HTMLTextAreaElement")&&(f.value="");break;case t._const.addTextElement:var p;if(m=(p=l.slice()).splice(p.length-1,1)[0],i=t.document.createTextNode(e[t._const.value]),!(s=ge(n,p)).childNodes)return!1;s.insertBefore(i,s.childNodes[m]||null),I(s.parentNode,"HTMLTextAreaElement")&&(s.parentNode.value=e[t._const.value]);break;default:console.log("unknown action")}return t.postDiffApply({diff:r.diff,node:r.node,newNode:i}),!0}function be(n,e,t){var s=n[e];n[e]=n[t],n[t]=s}function Re(n,e,t){(e=e.slice()).reverse(),e.forEach(function(s){(function(i,o,a){switch(o[a._const.action]){case a._const.addAttribute:o[a._const.action]=a._const.removeAttribute,Q(i,o,a);break;case a._const.modifyAttribute:be(o,a._const.oldValue,a._const.newValue),Q(i,o,a);break;case a._const.removeAttribute:o[a._const.action]=a._const.addAttribute,Q(i,o,a);break;case a._const.modifyTextElement:case a._const.modifyValue:case a._const.modifyComment:case a._const.modifyChecked:case a._const.modifySelected:case a._const.replaceElement:be(o,a._const.oldValue,a._const.newValue),Q(i,o,a);break;case a._const.relocateGroup:be(o,a._const.from,a._const.to),Q(i,o,a);break;case a._const.removeElement:o[a._const.action]=a._const.addElement,Q(i,o,a);break;case a._const.addElement:o[a._const.action]=a._const.removeElement,Q(i,o,a);break;case a._const.removeTextElement:o[a._const.action]=a._const.addTextElement,Q(i,o,a);break;case a._const.addTextElement:o[a._const.action]=a._const.removeTextElement,Q(i,o,a);break;default:console.log("unknown action")}})(n,s,t)})}var we=function(n){var e=[];return e.push(n.nodeName),n.nodeName!=="#text"&&n.nodeName!=="#comment"&&n.attributes&&(n.attributes.class&&e.push("".concat(n.nodeName,".").concat(n.attributes.class.replace(/ /g,"."))),n.attributes.id&&e.push("".concat(n.nodeName,"#").concat(n.attributes.id))),e},xe=function(n){var e={},t={};return n.forEach(function(s){we(s).forEach(function(i){var o=i in e;o||i in t?o&&(delete e[i],t[i]=!0):e[i]=!0})}),e},Le=function(n,e){var t=xe(n),s=xe(e),i={};return Object.keys(t).forEach(function(o){s[o]&&(i[o]=!0)}),i},$e=function(n){return delete n.outerDone,delete n.innerDone,delete n.valueDone,!n.childNodes||n.childNodes.every($e)},j=function(n){if(Object.prototype.hasOwnProperty.call(n,"data"))return{nodeName:n.nodeName==="#text"?"#text":"#comment",data:n.data};var e={nodeName:n.nodeName};return Object.prototype.hasOwnProperty.call(n,"attributes")&&(e.attributes=ve({},n.attributes)),Object.prototype.hasOwnProperty.call(n,"checked")&&(e.checked=n.checked),Object.prototype.hasOwnProperty.call(n,"value")&&(e.value=n.value),Object.prototype.hasOwnProperty.call(n,"selected")&&(e.selected=n.selected),Object.prototype.hasOwnProperty.call(n,"childNodes")&&(e.childNodes=n.childNodes.map(function(t){return j(t)})),e},Ne=function(n,e){if(!["nodeName","value","checked","selected","data"].every(function(i){return n[i]===e[i]}))return!1;if(Object.prototype.hasOwnProperty.call(n,"data"))return!0;if(Boolean(n.attributes)!==Boolean(e.attributes)||Boolean(n.childNodes)!==Boolean(e.childNodes))return!1;if(n.attributes){var t=Object.keys(n.attributes),s=Object.keys(e.attributes);if(t.length!==s.length||!t.every(function(i){return n.attributes[i]===e.attributes[i]}))return!1}return!(n.childNodes&&(n.childNodes.length!==e.childNodes.length||!n.childNodes.every(function(i,o){return Ne(i,e.childNodes[o])})))},Ve=function(n,e,t,s,i){if(i===void 0&&(i=!1),!n||!e||n.nodeName!==e.nodeName)return!1;if(["#text","#comment"].includes(n.nodeName))return!!i||n.data===e.data;if(n.nodeName in t)return!0;if(n.attributes&&e.attributes){if(n.attributes.id){if(n.attributes.id!==e.attributes.id)return!1;if("".concat(n.nodeName,"#").concat(n.attributes.id)in t)return!0}if(n.attributes.class&&n.attributes.class===e.attributes.class&&"".concat(n.nodeName,".").concat(n.attributes.class.replace(/ /g,"."))in t)return!0}if(s)return!0;var o=n.childNodes?n.childNodes.slice().reverse():[],a=e.childNodes?e.childNodes.slice().reverse():[];if(o.length!==a.length)return!1;if(i)return o.every(function(r,c){return r.nodeName===a[c].nodeName});var l=Le(o,a);return o.every(function(r,c){return Ve(r,a[c],l,!0,!0)})},he=function(n,e){return de([],new Array(n),!0).map(function(){return e})},je=function(n,e){for(var t=n.childNodes?n.childNodes:[],s=e.childNodes?e.childNodes:[],i=he(t.length,!1),o=he(s.length,!1),a=[],l=function(){return arguments[1]},r=!1,c=function(){var m=function(f,p,u,h){var v=0,D=[],M=f.length,d=p.length,y=de([],new Array(M+1),!0).map(function(){return[]}),L=Le(f,p),A=M===d;A&&f.some(function($,H){var w=we($),b=we(p[H]);return w.length!==b.length?(A=!1,!0):(w.some(function(g,N){if(g!==b[N])return A=!1,!0}),!A||void 0)});for(var T=0;T<M;T++)for(var k=f[T],x=0;x<d;x++){var V=p[x];u[T]||h[x]||!Ve(k,V,L,A)?y[T+1][x+1]=0:(y[T+1][x+1]=y[T][x]?y[T][x]+1:1,y[T+1][x+1]>=v&&(v=y[T+1][x+1],D=[T+1,x+1]))}return v!==0&&{oldValue:D[0]-v,newValue:D[1]-v,length:v}}(t,s,i,o);m?(a.push(m),de([],new Array(m.length),!0).map(l).forEach(function(f){return function(p,u,h,v){p[h.oldValue+v]=!0,u[h.newValue+v]=!0}(i,o,m,f)})):r=!0};!r;)c();return n.subsets=a,n.subsetsAge=100,a},Fe=function(){function n(){this.list=[]}return n.prototype.add=function(e){var t;(t=this.list).push.apply(t,e)},n.prototype.forEach=function(e){this.list.forEach(function(t){return e(t)})},n}();function _e(n,e){var t,s,i=n;for(e=e.slice();e.length>0;)s=e.splice(0,1)[0],t=i,i=i.childNodes?i.childNodes[s]:void 0;return{node:i,parentNode:t,nodeIndex:s}}function Be(n,e,t){return e.forEach(function(s){(function(i,o,a){var l,r,c,m;if(![a._const.addElement,a._const.addTextElement].includes(o[a._const.action])){var f=_e(i,o[a._const.route]);r=f.node,c=f.parentNode,m=f.nodeIndex}var p,u,h=[],v={diff:o,node:r};if(a.preVirtualDiffApply(v))return!0;switch(o[a._const.action]){case a._const.addAttribute:r.attributes||(r.attributes={}),r.attributes[o[a._const.name]]=o[a._const.value],o[a._const.name]==="checked"?r.checked=!0:o[a._const.name]==="selected"?r.selected=!0:r.nodeName==="INPUT"&&o[a._const.name]==="value"&&(r.value=o[a._const.value]);break;case a._const.modifyAttribute:r.attributes[o[a._const.name]]=o[a._const.newValue];break;case a._const.removeAttribute:delete r.attributes[o[a._const.name]],Object.keys(r.attributes).length===0&&delete r.attributes,o[a._const.name]==="checked"?r.checked=!1:o[a._const.name]==="selected"?delete r.selected:r.nodeName==="INPUT"&&o[a._const.name]==="value"&&delete r.value;break;case a._const.modifyTextElement:r.data=o[a._const.newValue],c.nodeName==="TEXTAREA"&&(c.value=o[a._const.newValue]);break;case a._const.modifyValue:r.value=o[a._const.newValue];break;case a._const.modifyComment:r.data=o[a._const.newValue];break;case a._const.modifyChecked:r.checked=o[a._const.newValue];break;case a._const.modifySelected:r.selected=o[a._const.newValue];break;case a._const.replaceElement:p=j(o[a._const.newValue]),c.childNodes[m]=p;break;case a._const.relocateGroup:r.childNodes.splice(o[a._const.from],o[a._const.groupLength]).reverse().forEach(function(d){return r.childNodes.splice(o[a._const.to],0,d)}),r.subsets&&r.subsets.forEach(function(d){if(o[a._const.from]<o[a._const.to]&&d.oldValue<=o[a._const.to]&&d.oldValue>o[a._const.from])d.oldValue-=o[a._const.groupLength],(y=d.oldValue+d.length-o[a._const.to])>0&&(h.push({oldValue:o[a._const.to]+o[a._const.groupLength],newValue:d.newValue+d.length-y,length:y}),d.length-=y);else if(o[a._const.from]>o[a._const.to]&&d.oldValue>o[a._const.to]&&d.oldValue<o[a._const.from]){var y;d.oldValue+=o[a._const.groupLength],(y=d.oldValue+d.length-o[a._const.to])>0&&(h.push({oldValue:o[a._const.to]+o[a._const.groupLength],newValue:d.newValue+d.length-y,length:y}),d.length-=y)}else d.oldValue===o[a._const.from]&&(d.oldValue=o[a._const.to])});break;case a._const.removeElement:c.childNodes.splice(m,1),c.subsets&&c.subsets.forEach(function(d){d.oldValue>m?d.oldValue-=1:d.oldValue===m?d.delete=!0:d.oldValue<m&&d.oldValue+d.length>m&&(d.oldValue+d.length-1===m?d.length--:(h.push({newValue:d.newValue+m-d.oldValue,oldValue:m,length:d.length-m+d.oldValue-1}),d.length=m-d.oldValue))}),r=c;break;case a._const.addElement:var D=(u=o[a._const.route].slice()).splice(u.length-1,1)[0];r=(l=_e(i,u))===null||l===void 0?void 0:l.node,p=j(o[a._const.element]),r.childNodes||(r.childNodes=[]),D>=r.childNodes.length?r.childNodes.push(p):r.childNodes.splice(D,0,p),r.subsets&&r.subsets.forEach(function(d){if(d.oldValue>=D)d.oldValue+=1;else if(d.oldValue<D&&d.oldValue+d.length>D){var y=d.oldValue+d.length-D;h.push({newValue:d.newValue+d.length-y,oldValue:D+1,length:y}),d.length-=y}});break;case a._const.removeTextElement:c.childNodes.splice(m,1),c.nodeName==="TEXTAREA"&&delete c.value,c.subsets&&c.subsets.forEach(function(d){d.oldValue>m?d.oldValue-=1:d.oldValue===m?d.delete=!0:d.oldValue<m&&d.oldValue+d.length>m&&(d.oldValue+d.length-1===m?d.length--:(h.push({newValue:d.newValue+m-d.oldValue,oldValue:m,length:d.length-m+d.oldValue-1}),d.length=m-d.oldValue))}),r=c;break;case a._const.addTextElement:var M=(u=o[a._const.route].slice()).splice(u.length-1,1)[0];p={nodeName:"#text",data:o[a._const.value]},(r=_e(i,u).node).childNodes||(r.childNodes=[]),M>=r.childNodes.length?r.childNodes.push(p):r.childNodes.splice(M,0,p),r.nodeName==="TEXTAREA"&&(r.value=o[a._const.newValue]),r.subsets&&r.subsets.forEach(function(d){if(d.oldValue>=M&&(d.oldValue+=1),d.oldValue<M&&d.oldValue+d.length>M){var y=d.oldValue+d.length-M;h.push({newValue:d.newValue+d.length-y,oldValue:M+1,length:y}),d.length-=y}});break;default:console.log("unknown action")}r.subsets&&(r.subsets=r.subsets.filter(function(d){return!d.delete&&d.oldValue!==d.newValue}),h.length&&(r.subsets=r.subsets.concat(h))),a.postVirtualDiffApply({node:v.node,diff:v.diff,newNode:p})})(n,s,t)}),!0}function te(n,e){e===void 0&&(e={valueDiffing:!0});var t={nodeName:n.nodeName};return I(n,"Text","Comment")?t.data=n.data:(n.attributes&&n.attributes.length>0&&(t.attributes={},Array.prototype.slice.call(n.attributes).forEach(function(s){return t.attributes[s.name]=s.value})),n.childNodes&&n.childNodes.length>0&&(t.childNodes=[],Array.prototype.slice.call(n.childNodes).forEach(function(s){return t.childNodes.push(te(s,e))})),e.valueDiffing&&(I(n,"HTMLTextAreaElement")&&(t.value=n.value),I(n,"HTMLInputElement")&&["radio","checkbox"].includes(n.type.toLowerCase())&&n.checked!==void 0?t.checked=n.checked:I(n,"HTMLButtonElement","HTMLDataElement","HTMLInputElement","HTMLLIElement","HTMLMeterElement","HTMLOptionElement","HTMLProgressElement","HTMLParamElement")&&(t.value=n.value),I(n,"HTMLOptionElement")&&(t.selected=n.selected))),t}var qe=/<\s*\/*[a-zA-Z:_][a-zA-Z0-9:_\-.]*\s*(?:"[^"]*"['"]*|'[^']*'['"]*|[^'"/>])*\/*\s*>|<!--(?:.|\n|\r)*?-->/g,ze=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function Ee(n){return n.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}var We={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuItem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},Te=function(n,e){var t={nodeName:"",attributes:{}},s=!1,i=n.match(/<\/?([^\s]+?)[/\s>]/);if(i&&(t.nodeName=e||i[1]==="svg"?i[1]:i[1].toUpperCase(),(We[i[1]]||n.charAt(n.length-2)==="/")&&(s=!0),t.nodeName.startsWith("!--"))){var o=n.indexOf("-->");return{type:"comment",node:{nodeName:"#comment",data:o!==-1?n.slice(4,o):""},voidElement:s}}for(var a=new RegExp(ze),l=null,r=!1;!r;)if((l=a.exec(n))===null)r=!0;else if(l[0].trim())if(l[1]){var c=l[1].trim(),m=[c,""];c.indexOf("=")>-1&&(m=c.split("=")),t.attributes[m[0]]=m[1],a.lastIndex--}else l[2]&&(t.attributes[l[2]]=l[3].trim().substring(1,l[3].length-1));return{type:"tag",node:t,voidElement:s}},se=function(n,e){e===void 0&&(e={valueDiffing:!0,caseSensitive:!1});var t,s=[],i=-1,o=[],a=!1;if(n.indexOf("<")!==0){var l=n.indexOf("<");s.push({nodeName:"#text",data:l===-1?n:n.substring(0,l)})}return n.replace(qe,function(r,c){var m=r.charAt(1)!=="/",f=r.startsWith("<!--"),p=c+r.length,u=n.charAt(p);if(f){var h=Te(r,e.caseSensitive).node;if(i<0)return s.push(h),"";var v=o[i];return v&&h.nodeName&&(v.node.childNodes||(v.node.childNodes=[]),v.node.childNodes.push(h)),""}if(m){if((t=Te(r,e.caseSensitive||a)).node.nodeName==="svg"&&(a=!0),i++,!t.voidElement&&u&&u!=="<"){t.node.childNodes||(t.node.childNodes=[]);var D=Ee(n.slice(p,n.indexOf("<",p)));t.node.childNodes.push({nodeName:"#text",data:D}),e.valueDiffing&&t.node.nodeName==="TEXTAREA"&&(t.node.value=D)}i===0&&t.node.nodeName&&s.push(t.node);var M=o[i-1];M&&t.node.nodeName&&(M.node.childNodes||(M.node.childNodes=[]),M.node.childNodes.push(t.node)),o[i]=t}if((!m||t.voidElement)&&(i>-1&&(t.voidElement||e.caseSensitive&&t.node.nodeName===r.slice(2,-1)||!e.caseSensitive&&t.node.nodeName.toUpperCase()===r.slice(2,-1).toUpperCase())&&--i>-1&&(t.node.nodeName==="svg"&&(a=!1),t=o[i]),u!=="<"&&u)){var d=i===-1?s:o[i].node.childNodes||[],y=n.indexOf("<",p);D=Ee(n.slice(p,y===-1?void 0:y)),d.push({nodeName:"#text",data:D})}return""}),s[0]},Ue=function(){function n(e,t,s){this.options=s,this.t1=typeof Element<"u"&&I(e,"Element")?te(e,this.options):typeof e=="string"?se(e,this.options):JSON.parse(JSON.stringify(e)),this.t2=typeof Element<"u"&&I(t,"Element")?te(t,this.options):typeof t=="string"?se(t,this.options):JSON.parse(JSON.stringify(t)),this.diffcount=0,this.foundAll=!1,this.debug&&(this.t1Orig=typeof Element<"u"&&I(e,"Element")?te(e,this.options):typeof e=="string"?se(e,this.options):JSON.parse(JSON.stringify(e)),this.t2Orig=typeof Element<"u"&&I(t,"Element")?te(t,this.options):typeof t=="string"?se(t,this.options):JSON.parse(JSON.stringify(t))),this.tracker=new Fe}return n.prototype.init=function(){return this.findDiffs(this.t1,this.t2)},n.prototype.findDiffs=function(e,t){var s;do{if(this.options.debug&&(this.diffcount+=1,this.diffcount>this.options.diffcap))throw new Error("surpassed diffcap:".concat(JSON.stringify(this.t1Orig)," -> ").concat(JSON.stringify(this.t2Orig)));(s=this.findNextDiff(e,t,[])).length===0&&(Ne(e,t)||(this.foundAll?console.error("Could not find remaining diffs!"):(this.foundAll=!0,$e(e),s=this.findNextDiff(e,t,[])))),s.length>0&&(this.foundAll=!1,this.tracker.add(s),Be(e,s,this.options))}while(s.length>0);return this.tracker.list},n.prototype.findNextDiff=function(e,t,s){var i,o;if(this.options.maxDepth&&s.length>this.options.maxDepth)return[];if(!e.outerDone){if(i=this.findOuterDiff(e,t,s),this.options.filterOuterDiff&&(o=this.options.filterOuterDiff(e,t,i))&&(i=o),i.length>0)return e.outerDone=!0,i;e.outerDone=!0}if(Object.prototype.hasOwnProperty.call(e,"data"))return[];if(!e.innerDone){if((i=this.findInnerDiff(e,t,s)).length>0)return i;e.innerDone=!0}if(this.options.valueDiffing&&!e.valueDone){if((i=this.findValueDiff(e,t,s)).length>0)return e.valueDone=!0,i;e.valueDone=!0}return[]},n.prototype.findOuterDiff=function(e,t,s){var i,o,a,l,r,c,m=[];if(e.nodeName!==t.nodeName){if(!s.length)throw new Error("Top level nodes have to be of the same kind.");return[new C().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,j(e)).setValue(this.options._const.newValue,j(t)).setValue(this.options._const.route,s)]}if(s.length&&this.options.diffcap<Math.abs((e.childNodes||[]).length-(t.childNodes||[]).length))return[new C().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,j(e)).setValue(this.options._const.newValue,j(t)).setValue(this.options._const.route,s)];if(Object.prototype.hasOwnProperty.call(e,"data")&&e.data!==t.data)return e.nodeName==="#text"?[new C().setValue(this.options._const.action,this.options._const.modifyTextElement).setValue(this.options._const.route,s).setValue(this.options._const.oldValue,e.data).setValue(this.options._const.newValue,t.data)]:[new C().setValue(this.options._const.action,this.options._const.modifyComment).setValue(this.options._const.route,s).setValue(this.options._const.oldValue,e.data).setValue(this.options._const.newValue,t.data)];for(o=e.attributes?Object.keys(e.attributes).sort():[],a=t.attributes?Object.keys(t.attributes).sort():[],l=o.length,c=0;c<l;c++)i=o[c],(r=a.indexOf(i))===-1?m.push(new C().setValue(this.options._const.action,this.options._const.removeAttribute).setValue(this.options._const.route,s).setValue(this.options._const.name,i).setValue(this.options._const.value,e.attributes[i])):(a.splice(r,1),e.attributes[i]!==t.attributes[i]&&m.push(new C().setValue(this.options._const.action,this.options._const.modifyAttribute).setValue(this.options._const.route,s).setValue(this.options._const.name,i).setValue(this.options._const.oldValue,e.attributes[i]).setValue(this.options._const.newValue,t.attributes[i])));for(l=a.length,c=0;c<l;c++)i=a[c],m.push(new C().setValue(this.options._const.action,this.options._const.addAttribute).setValue(this.options._const.route,s).setValue(this.options._const.name,i).setValue(this.options._const.value,t.attributes[i]));return m},n.prototype.findInnerDiff=function(e,t,s){var i=e.childNodes?e.childNodes.slice():[],o=t.childNodes?t.childNodes.slice():[],a=Math.max(i.length,o.length),l=Math.abs(i.length-o.length),r=[],c=0;if(!this.options.maxChildCount||a<this.options.maxChildCount){var m=Boolean(e.subsets&&e.subsetsAge--),f=m?e.subsets:e.childNodes&&t.childNodes?je(e,t):[];if(f.length>0&&(r=this.attemptGroupRelocation(e,t,f,s,m)).length>0)return r}for(var p=0;p<a;p+=1){var u=i[p],h=o[p];l&&(u&&!h?u.nodeName==="#text"?(r.push(new C().setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,s.concat(c)).setValue(this.options._const.value,u.data)),c-=1):(r.push(new C().setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.route,s.concat(c)).setValue(this.options._const.element,j(u))),c-=1):h&&!u&&(h.nodeName==="#text"?r.push(new C().setValue(this.options._const.action,this.options._const.addTextElement).setValue(this.options._const.route,s.concat(c)).setValue(this.options._const.value,h.data)):r.push(new C().setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.route,s.concat(c)).setValue(this.options._const.element,j(h))))),u&&h&&(!this.options.maxChildCount||a<this.options.maxChildCount?r=r.concat(this.findNextDiff(u,h,s.concat(c))):Ne(u,h)||(i.length>o.length?(u.nodeName==="#text"?r.push(new C().setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,s.concat(c)).setValue(this.options._const.value,u.data)):r.push(new C().setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.element,j(u)).setValue(this.options._const.route,s.concat(c))),i.splice(p,1),p-=1,c-=1,l-=1):i.length<o.length?(r=r.concat([new C().setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.element,j(h)).setValue(this.options._const.route,s.concat(c))]),i.splice(p,0,j(h)),l-=1):r=r.concat([new C().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,j(u)).setValue(this.options._const.newValue,j(h)).setValue(this.options._const.route,s.concat(c))]))),c+=1}return e.innerDone=!0,r},n.prototype.attemptGroupRelocation=function(e,t,s,i,o){for(var a,l,r,c,m,f=function(T,k,x){var V=T.childNodes?he(T.childNodes.length,!0):[],$=k.childNodes?he(k.childNodes.length,!0):[],H=0;return x.forEach(function(w){for(var b=w.oldValue+w.length,g=w.newValue+w.length,N=w.oldValue;N<b;N+=1)V[N]=H;for(N=w.newValue;N<g;N+=1)$[N]=H;H+=1}),{gaps1:V,gaps2:$}}(e,t,s),p=f.gaps1,u=f.gaps2,h=e.childNodes.slice(),v=t.childNodes.slice(),D=Math.min(p.length,u.length),M=[],d=0,y=0;d<D;y+=1,d+=1)if(!o||p[d]!==!0&&u[d]!==!0){if(p[y]===!0)if((c=h[y]).nodeName==="#text")if(v[d].nodeName==="#text"){if(c.data!==v[d].data){for(var L=y;h.length>L+1&&h[L+1].nodeName==="#text";)if(L+=1,v[d].data===h[L].data){m=!0;break}m||M.push(new C().setValue(this.options._const.action,this.options._const.modifyTextElement).setValue(this.options._const.route,i.concat(y)).setValue(this.options._const.oldValue,c.data).setValue(this.options._const.newValue,v[d].data))}}else M.push(new C().setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,i.concat(y)).setValue(this.options._const.value,c.data)),p.splice(y,1),h.splice(y,1),D=Math.min(p.length,u.length),y-=1,d-=1;else u[d]===!0?M.push(new C().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,j(c)).setValue(this.options._const.newValue,j(v[d])).setValue(this.options._const.route,i.concat(y))):(M.push(new C().setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.route,i.concat(y)).setValue(this.options._const.element,j(c))),p.splice(y,1),h.splice(y,1),D=Math.min(p.length,u.length),y-=1,d-=1);else if(u[d]===!0)(c=v[d]).nodeName==="#text"?(M.push(new C().setValue(this.options._const.action,this.options._const.addTextElement).setValue(this.options._const.route,i.concat(y)).setValue(this.options._const.value,c.data)),p.splice(y,0,!0),h.splice(y,0,{nodeName:"#text",data:c.data}),D=Math.min(p.length,u.length)):(M.push(new C().setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.route,i.concat(y)).setValue(this.options._const.element,j(c))),p.splice(y,0,!0),h.splice(y,0,j(c)),D=Math.min(p.length,u.length));else if(p[y]!==u[d]){if(M.length>0)return M;if(r=s[p[y]],(l=Math.min(r.newValue,h.length-r.length))!==r.oldValue){a=!1;for(var A=0;A<r.length;A+=1)Ve(h[l+A],h[r.oldValue+A],{},!1,!0)||(a=!0);if(a)return[new C().setValue(this.options._const.action,this.options._const.relocateGroup).setValue(this.options._const.groupLength,r.length).setValue(this.options._const.from,r.oldValue).setValue(this.options._const.to,l).setValue(this.options._const.route,i)]}}}return M},n.prototype.findValueDiff=function(e,t,s){var i=[];return e.selected!==t.selected&&i.push(new C().setValue(this.options._const.action,this.options._const.modifySelected).setValue(this.options._const.oldValue,e.selected).setValue(this.options._const.newValue,t.selected).setValue(this.options._const.route,s)),(e.value||t.value)&&e.value!==t.value&&e.nodeName!=="OPTION"&&i.push(new C().setValue(this.options._const.action,this.options._const.modifyValue).setValue(this.options._const.oldValue,e.value||"").setValue(this.options._const.newValue,t.value||"").setValue(this.options._const.route,s)),e.checked!==t.checked&&i.push(new C().setValue(this.options._const.action,this.options._const.modifyChecked).setValue(this.options._const.oldValue,e.checked).setValue(this.options._const.newValue,t.checked).setValue(this.options._const.route,s)),i},n}(),Je={debug:!1,diffcap:10,maxDepth:!1,maxChildCount:50,valueDiffing:!0,textDiff:function(n,e,t,s){n.data=s},preVirtualDiffApply:function(){},postVirtualDiffApply:function(){},preDiffApply:function(){},postDiffApply:function(){},filterOuterDiff:null,compress:!1,_const:!1,document:!(typeof window>"u"||!window.document)&&window.document,components:[]},Qe=function(){function n(e){if(e===void 0&&(e={}),Object.entries(Je).forEach(function(i){var o=i[0],a=i[1];Object.prototype.hasOwnProperty.call(e,o)||(e[o]=a)}),!e._const){var t=["addAttribute","modifyAttribute","removeAttribute","modifyTextElement","relocateGroup","removeElement","addElement","removeTextElement","addTextElement","replaceElement","modifyValue","modifyChecked","modifySelected","modifyComment","action","route","oldValue","newValue","element","group","groupLength","from","to","name","value","data","attributes","nodeName","childNodes","checked","selected"],s={};e.compress?t.forEach(function(i,o){return s[i]=o}):t.forEach(function(i){return s[i]=i}),e._const=s}this.options=e}return n.prototype.apply=function(e,t){return function(s,i,o){return i.every(function(a){return Q(s,a,o)})}(e,t,this.options)},n.prototype.undo=function(e,t){return Re(e,t,this.options)},n.prototype.diff=function(e,t){return new Ue(e,t,this.options).init()},n}();const De=(n,e,t,{classes:s,format:i,hiddenHeader:o,sortable:a,scrollY:l,type:r},{noColumnWidths:c,unhideHeader:m})=>({nodeName:"TR",childNodes:n.map((f,p)=>{var D;const u=e[p]||{type:r,format:i,sortable:!0,searchable:!0};if(u.hidden)return;const h=f.attributes?{...f.attributes}:{};if(u.sortable&&a&&(!l.length||m)&&(u.filter?h["data-filterable"]="true":h["data-sortable"]="true"),u.headerClass&&(h.class=U(h.class,u.headerClass)),t.sort&&t.sort.column===p){const M=t.sort.dir==="asc"?s.ascending:s.descending;h.class=U(h.class,M),h["aria-sort"]=t.sort.dir==="asc"?"ascending":"descending"}else t.filters[p]&&(h.class=U(h.class,s.filterActive));if(t.widths[p]&&!c){const M=`width: ${t.widths[p]}%;`;h.style=U(h.style,M)}if(l.length&&!m){const M="padding-bottom: 0;padding-top: 0;border: 0;";h.style=U(h.style,M)}const v=f.type==="html"?f.data:[{nodeName:"#text",data:(D=f.text)!=null?D:String(f.data)}];return{nodeName:"TH",attributes:h,childNodes:!o&&!l.length||m?u.sortable&&a?[{nodeName:"BUTTON",attributes:{class:u.filter?s.filter:s.sorter},childNodes:v}]:v:[{nodeName:"#text",data:""}]}}).filter(f=>f)}),Se=(n,e,t,s,i,o,{classes:a,hiddenHeader:l,header:r,footer:c,format:m,sortable:f,scrollY:p,type:u,rowRender:h,tabIndex:v},{noColumnWidths:D,unhideHeader:M,renderHeader:d},y,L)=>{const A={nodeName:"TABLE",attributes:{...n},childNodes:[{nodeName:"TBODY",childNodes:t.map(({row:T,index:k})=>{const x={nodeName:"TR",attributes:{...T.attributes,"data-index":String(k)},childNodes:T.cells.map((V,$)=>{const H=s[$]||{type:u,format:m,sortable:!0,searchable:!0};if(H.hidden)return;const w={nodeName:"TD",attributes:V.attributes?{...V.attributes}:{},childNodes:H.type==="html"?V.data:[{nodeName:"#text",data:ie(V)}]};if(r||c||!i.widths[$]||D||(w.attributes.style=U(w.attributes.style,`width: ${i.widths[$]}%;`)),H.cellClass&&(w.attributes.class=U(w.attributes.class,H.cellClass)),H.render){const b=H.render(V.data,w,k,$);if(b){if(typeof b!="string")return b;{const g=se(`<td>${b}</td>`);g.childNodes.length===1&&["#text","#comment"].includes(g.childNodes[0].nodeName)?w.childNodes[0].data=b:w.childNodes=g.childNodes}}}return w}).filter(V=>V)};if(k===o&&(x.attributes.class=U(x.attributes.class,a.cursor)),h){const V=h(T,x,k);if(V){if(typeof V!="string")return V;{const $=se(`<tr>${V}</tr>`);!$.childNodes||$.childNodes.length===1&&["#text","#comment"].includes($.childNodes[0].nodeName)?x.childNodes[0].data=V:x.childNodes=$.childNodes}}}return x})}]};if(A.attributes.class=U(A.attributes.class,a.table),r||c||d){const T=De(e,s,i,{classes:a,hiddenHeader:l,sortable:f,scrollY:p},{noColumnWidths:D,unhideHeader:M});if(r||d){const k={nodeName:"THEAD",childNodes:[T]};!p.length&&!l||M||(k.attributes={style:"height: 0px;"}),A.childNodes.unshift(k)}if(c){const k={nodeName:"TFOOT",childNodes:[r?structuredClone(T):T]};!p.length&&!l||M||(k.attributes={style:"height: 0px;"}),A.childNodes.push(k)}}return y.forEach(T=>A.childNodes.push(T)),L.forEach(T=>A.childNodes.push(T)),v!==!1&&(A.attributes.tabindex=String(v)),A};function Pe(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var oe=Pe(function(){var n=1e3,e=6e4,t=36e5,s="millisecond",i="second",o="minute",a="hour",l="day",r="week",c="month",m="quarter",f="year",p="date",u="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,D={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(w){var b=["th","st","nd","rd"],g=w%100;return"["+w+(b[(g-20)%10]||b[g]||b[0])+"]"}},M=function(w,b,g){var N=String(w);return!N||N.length>=b?w:""+Array(b+1-N.length).join(g)+w},d={s:M,z:function(w){var b=-w.utcOffset(),g=Math.abs(b),N=Math.floor(g/60),_=g%60;return(b<=0?"+":"-")+M(N,2,"0")+":"+M(_,2,"0")},m:function w(b,g){if(b.date()<g.date())return-w(g,b);var N=12*(g.year()-b.year())+(g.month()-b.month()),_=b.clone().add(N,c),O=g-_<0,E=b.clone().add(N+(O?-1:1),c);return+(-(N+(g-_)/(O?_-E:E-_))||0)},a:function(w){return w<0?Math.ceil(w)||0:Math.floor(w)},p:function(w){return{M:c,y:f,w:r,d:l,D:p,h:a,m:o,s:i,ms:s,Q:m}[w]||String(w||"").toLowerCase().replace(/s$/,"")},u:function(w){return w===void 0}},y="en",L={};L[y]=D;var A="$isDayjsObject",T=function(w){return w instanceof $||!(!w||!w[A])},k=function w(b,g,N){var _;if(!b)return y;if(typeof b=="string"){var O=b.toLowerCase();L[O]&&(_=O),g&&(L[O]=g,_=O);var E=b.split("-");if(!_&&E.length>1)return w(E[0])}else{var P=b.name;L[P]=b,_=P}return!N&&_&&(y=_),_||!N&&y},x=function(w,b){if(T(w))return w.clone();var g=typeof b=="object"?b:{};return g.date=w,g.args=arguments,new $(g)},V=d;V.l=k,V.i=T,V.w=function(w,b){return x(w,{locale:b.$L,utc:b.$u,x:b.$x,$offset:b.$offset})};var $=function(){function w(g){this.$L=k(g.locale,null,!0),this.parse(g),this.$x=this.$x||g.x||{},this[A]=!0}var b=w.prototype;return b.parse=function(g){this.$d=function(N){var _=N.date,O=N.utc;if(_===null)return new Date(NaN);if(V.u(_))return new Date;if(_ instanceof Date)return new Date(_);if(typeof _=="string"&&!/Z$/i.test(_)){var E=_.match(h);if(E){var P=E[2]-1||0,Y=(E[7]||"0").substring(0,3);return O?new Date(Date.UTC(E[1],P,E[3]||1,E[4]||0,E[5]||0,E[6]||0,Y)):new Date(E[1],P,E[3]||1,E[4]||0,E[5]||0,E[6]||0,Y)}}return new Date(_)}(g),this.init()},b.init=function(){var g=this.$d;this.$y=g.getFullYear(),this.$M=g.getMonth(),this.$D=g.getDate(),this.$W=g.getDay(),this.$H=g.getHours(),this.$m=g.getMinutes(),this.$s=g.getSeconds(),this.$ms=g.getMilliseconds()},b.$utils=function(){return V},b.isValid=function(){return this.$d.toString()!==u},b.isSame=function(g,N){var _=x(g);return this.startOf(N)<=_&&_<=this.endOf(N)},b.isAfter=function(g,N){return x(g)<this.startOf(N)},b.isBefore=function(g,N){return this.endOf(N)<x(g)},b.$g=function(g,N,_){return V.u(g)?this[N]:this.set(_,g)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(g,N){var _=this,O=!!V.u(N)||N,E=V.p(g),P=function(W,B){var z=V.w(_.$u?Date.UTC(_.$y,B,W):new Date(_.$y,B,W),_);return O?z:z.endOf(l)},Y=function(W,B){return V.w(_.toDate()[W].apply(_.toDate("s"),(O?[0,0,0,0]:[23,59,59,999]).slice(B)),_)},R=this.$W,F=this.$M,q=this.$D,X="set"+(this.$u?"UTC":"");switch(E){case f:return O?P(1,0):P(31,11);case c:return O?P(1,F):P(0,F+1);case r:var J=this.$locale().weekStart||0,Z=(R<J?R+7:R)-J;return P(O?q-Z:q+(6-Z),F);case l:case p:return Y(X+"Hours",0);case a:return Y(X+"Minutes",1);case o:return Y(X+"Seconds",2);case i:return Y(X+"Milliseconds",3);default:return this.clone()}},b.endOf=function(g){return this.startOf(g,!1)},b.$set=function(g,N){var _,O=V.p(g),E="set"+(this.$u?"UTC":""),P=(_={},_[l]=E+"Date",_[p]=E+"Date",_[c]=E+"Month",_[f]=E+"FullYear",_[a]=E+"Hours",_[o]=E+"Minutes",_[i]=E+"Seconds",_[s]=E+"Milliseconds",_)[O],Y=O===l?this.$D+(N-this.$W):N;if(O===c||O===f){var R=this.clone().set(p,1);R.$d[P](Y),R.init(),this.$d=R.set(p,Math.min(this.$D,R.daysInMonth())).$d}else P&&this.$d[P](Y);return this.init(),this},b.set=function(g,N){return this.clone().$set(g,N)},b.get=function(g){return this[V.p(g)]()},b.add=function(g,N){var _,O=this;g=Number(g);var E=V.p(N),P=function(F){var q=x(O);return V.w(q.date(q.date()+Math.round(F*g)),O)};if(E===c)return this.set(c,this.$M+g);if(E===f)return this.set(f,this.$y+g);if(E===l)return P(1);if(E===r)return P(7);var Y=(_={},_[o]=e,_[a]=t,_[i]=n,_)[E]||1,R=this.$d.getTime()+g*Y;return V.w(R,this)},b.subtract=function(g,N){return this.add(-1*g,N)},b.format=function(g){var N=this,_=this.$locale();if(!this.isValid())return _.invalidDate||u;var O=g||"YYYY-MM-DDTHH:mm:ssZ",E=V.z(this),P=this.$H,Y=this.$m,R=this.$M,F=_.weekdays,q=_.months,X=_.meridiem,J=function(B,z,G,K){return B&&(B[z]||B(N,O))||G[z].slice(0,K)},Z=function(B){return V.s(P%12||12,B,"0")},W=X||function(B,z,G){var K=B<12?"AM":"PM";return G?K.toLowerCase():K};return O.replace(v,function(B,z){return z||function(G){switch(G){case"YY":return String(N.$y).slice(-2);case"YYYY":return V.s(N.$y,4,"0");case"M":return R+1;case"MM":return V.s(R+1,2,"0");case"MMM":return J(_.monthsShort,R,q,3);case"MMMM":return J(q,R);case"D":return N.$D;case"DD":return V.s(N.$D,2,"0");case"d":return String(N.$W);case"dd":return J(_.weekdaysMin,N.$W,F,2);case"ddd":return J(_.weekdaysShort,N.$W,F,3);case"dddd":return F[N.$W];case"H":return String(P);case"HH":return V.s(P,2,"0");case"h":return Z(1);case"hh":return Z(2);case"a":return W(P,Y,!0);case"A":return W(P,Y,!1);case"m":return String(Y);case"mm":return V.s(Y,2,"0");case"s":return String(N.$s);case"ss":return V.s(N.$s,2,"0");case"SSS":return V.s(N.$ms,3,"0");case"Z":return E}return null}(B)||E.replace(":","")})},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(g,N,_){var O,E=this,P=V.p(N),Y=x(g),R=(Y.utcOffset()-this.utcOffset())*e,F=this-Y,q=function(){return V.m(E,Y)};switch(P){case f:O=q()/12;break;case c:O=q();break;case m:O=q()/3;break;case r:O=(F-R)/6048e5;break;case l:O=(F-R)/864e5;break;case a:O=F/t;break;case o:O=F/e;break;case i:O=F/n;break;default:O=F}return _?O:V.a(O)},b.daysInMonth=function(){return this.endOf(c).$D},b.$locale=function(){return L[this.$L]},b.locale=function(g,N){if(!g)return this.$L;var _=this.clone(),O=k(g,N,!0);return O&&(_.$L=O),_},b.clone=function(){return V.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},w}(),H=$.prototype;return x.prototype=H,[["$ms",s],["$s",i],["$m",o],["$H",a],["$W",l],["$M",c],["$y",f],["$D",p]].forEach(function(w){H[w[1]]=function(b){return this.$g(b,w[0],w[1])}}),x.extend=function(w,b){return w.$i||(w(b,$,x),w.$i=!0),x},x.locale=k,x.isDayjs=T,x.unix=function(w){return x(1e3*w)},x.en=L[y],x.Ls=L,x.p={},x}()),Ze=Pe(function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},e=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,t=/\d\d/,s=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,o={},a=function(u){return(u=+u)+(u>68?1900:2e3)},l=function(u){return function(h){this[u]=+h}},r=[/[+-]\d\d:?(\d\d)?|Z/,function(u){(this.zone||(this.zone={})).offset=function(h){if(!h||h==="Z")return 0;var v=h.match(/([+-]|\d\d)/g),D=60*v[1]+(+v[2]||0);return D===0?0:v[0]==="+"?-D:D}(u)}],c=function(u){var h=o[u];return h&&(h.indexOf?h:h.s.concat(h.f))},m=function(u,h){var v,D=o.meridiem;if(D){for(var M=1;M<=24;M+=1)if(u.indexOf(D(M,0,h))>-1){v=M>12;break}}else v=u===(h?"pm":"PM");return v},f={A:[i,function(u){this.afternoon=m(u,!1)}],a:[i,function(u){this.afternoon=m(u,!0)}],S:[/\d/,function(u){this.milliseconds=100*+u}],SS:[t,function(u){this.milliseconds=10*+u}],SSS:[/\d{3}/,function(u){this.milliseconds=+u}],s:[s,l("seconds")],ss:[s,l("seconds")],m:[s,l("minutes")],mm:[s,l("minutes")],H:[s,l("hours")],h:[s,l("hours")],HH:[s,l("hours")],hh:[s,l("hours")],D:[s,l("day")],DD:[t,l("day")],Do:[i,function(u){var h=o.ordinal,v=u.match(/\d+/);if(this.day=v[0],h)for(var D=1;D<=31;D+=1)h(D).replace(/\[|\]/g,"")===u&&(this.day=D)}],M:[s,l("month")],MM:[t,l("month")],MMM:[i,function(u){var h=c("months"),v=(c("monthsShort")||h.map(function(D){return D.slice(0,3)})).indexOf(u)+1;if(v<1)throw new Error;this.month=v%12||v}],MMMM:[i,function(u){var h=c("months").indexOf(u)+1;if(h<1)throw new Error;this.month=h%12||h}],Y:[/[+-]?\d+/,l("year")],YY:[t,function(u){this.year=a(u)}],YYYY:[/\d{4}/,l("year")],Z:r,ZZ:r};function p(u){var h,v;h=u,v=o&&o.formats;for(var D=(u=h.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(k,x,V){var $=V&&V.toUpperCase();return x||v[V]||n[V]||v[$].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(H,w,b){return w||b.slice(1)})})).match(e),M=D.length,d=0;d<M;d+=1){var y=D[d],L=f[y],A=L&&L[0],T=L&&L[1];D[d]=T?{regex:A,parser:T}:y.replace(/^\[|\]$/g,"")}return function(k){for(var x={},V=0,$=0;V<M;V+=1){var H=D[V];if(typeof H=="string")$+=H.length;else{var w=H.regex,b=H.parser,g=k.slice($),N=w.exec(g)[0];b.call(x,N),k=k.replace(N,"")}}return function(_){var O=_.afternoon;if(O!==void 0){var E=_.hours;O?E<12&&(_.hours+=12):E===12&&(_.hours=0),delete _.afternoon}}(x),x}}return function(u,h,v){v.p.customParseFormat=!0,u&&u.parseTwoDigitYear&&(a=u.parseTwoDigitYear);var D=h.prototype,M=D.parse;D.parse=function(d){var y=d.date,L=d.utc,A=d.args;this.$u=L;var T=A[1];if(typeof T=="string"){var k=A[2]===!0,x=A[3]===!0,V=k||x,$=A[2];x&&($=A[2]),o=this.$locale(),!k&&$&&(o=v.Ls[$]),this.$d=function(g,N,_){try{if(["x","X"].indexOf(N)>-1)return new Date((N==="X"?1e3:1)*g);var O=p(N)(g),E=O.year,P=O.month,Y=O.day,R=O.hours,F=O.minutes,q=O.seconds,X=O.milliseconds,J=O.zone,Z=new Date,W=Y||(E||P?1:Z.getDate()),B=E||Z.getFullYear(),z=0;E&&!P||(z=P>0?P-1:Z.getMonth());var G=R||0,K=F||0,ue=q||0,pe=X||0;return J?new Date(Date.UTC(B,z,W,G,K,ue,pe+60*J.offset*1e3)):_?new Date(Date.UTC(B,z,W,G,K,ue,pe)):new Date(B,z,W,G,K,ue,pe)}catch{return new Date("")}}(y,T,L),this.init(),$&&$!==!0&&(this.$L=this.locale($).$L),V&&y!=this.format(T)&&(this.$d=new Date("")),o={}}else if(T instanceof Array)for(var H=T.length,w=1;w<=H;w+=1){A[1]=T[w-1];var b=v.apply(this,A);if(b.isValid()){this.$d=b.$d,this.$L=b.$L,this.init();break}w===H&&(this.$d=new Date(""))}else M.call(this,d)}}}());oe.extend(Ze);const ke=(n,e)=>{let t;if(e)switch(e){case"ISO_8601":t=n;break;case"RFC_2822":t=oe(n.slice(5),"DD MMM YYYY HH:mm:ss ZZ").unix();break;case"MYSQL":t=oe(n,"YYYY-MM-DD hh:mm:ss").unix();break;case"UNIX":t=oe(n).unix();break;default:t=oe(n,e,!0).valueOf()}return t},ne=(n,e)=>{if((n==null?void 0:n.constructor)===Object&&Object.prototype.hasOwnProperty.call(n,"data")&&!Object.keys(n).find(s=>!["text","order","data","attributes"].includes(s)))return n;const t={data:n};switch(e.type){case"string":typeof n!="string"&&(t.text=String(t.data),t.order=t.text);break;case"date":e.format&&(t.order=ke(String(t.data),e.format));break;case"number":t.text=String(t.data),t.data=parseFloat(t.data),t.order=t.data;break;case"html":{const s=Array.isArray(t.data)?{nodeName:"TD",childNodes:t.data}:se(`<td>${String(t.data)}</td>`);t.data=s.childNodes||[];const i=le(s);t.text=i,t.order=i;break}case"boolean":typeof t.data=="string"&&(t.data=t.data.toLowerCase().trim()),t.data=!["false",!1,null,void 0,0].includes(t.data),t.order=t.data?1:0,t.text=String(t.data);break;case"other":t.text="",t.order=0;break;default:t.text=JSON.stringify(t.data)}return t},re=n=>{if(n instanceof Object&&n.constructor===Object&&n.hasOwnProperty("data")&&(typeof n.text=="string"||typeof n.data=="string"))return n;const e={data:n};if(typeof n=="string"){if(n.length){const t=se(`<th>${n}</th>`);if(t.childNodes&&(t.childNodes.length!==1||t.childNodes[0].nodeName!=="#text")){e.data=t.childNodes,e.type="html";const s=le(t);e.text=s}}}else[null,void 0].includes(n)?e.text="":e.text=JSON.stringify(n);return e},Ae=(n,e=void 0,t,s,i)=>{var a,l;const o={data:[],headings:[]};if(n.headings)o.headings=n.headings.map(r=>re(r));else if(e!=null&&e.tHead)o.headings=Array.from(e.tHead.querySelectorAll("th")).map((r,c)=>{var p,u,h,v,D;const m=(M=>{const d=te(M,{valueDiffing:!1});let y;return y=!d.childNodes||d.childNodes.length===1&&d.childNodes[0].nodeName==="#text"?{data:M.innerText,type:"string"}:{data:d.childNodes,type:"html",text:le(d)},y.attributes=d.attributes,y})(r);t[c]||(t[c]={type:s,format:i,searchable:!0,sortable:!0});const f=t[c];return((p=r.dataset.sortable)==null?void 0:p.trim().toLowerCase())!=="false"&&((u=r.dataset.sort)==null?void 0:u.trim().toLowerCase())!=="false"||(f.sortable=!1),((h=r.dataset.searchable)==null?void 0:h.trim().toLowerCase())==="false"&&(f.searchable=!1),((v=r.dataset.hidden)==null?void 0:v.trim().toLowerCase())!=="true"&&((D=r.getAttribute("hidden"))==null?void 0:D.trim().toLowerCase())!=="true"||(f.hidden=!0),["number","string","html","date","boolean","other"].includes(r.dataset.type)&&(f.type=r.dataset.type,f.type==="date"&&r.dataset.format&&(f.format=r.dataset.format)),m});else if((a=n.data)!=null&&a.length){const r=n.data[0],c=Array.isArray(r)?r:r.cells;o.headings=c.map(m=>re(""))}else e!=null&&e.tBodies.length&&(o.headings=Array.from(e.tBodies[0].rows[0].cells).map(r=>re("")));for(let r=0;r<o.headings.length;r++)t[r]||(t[r]={type:s,format:i,sortable:!0,searchable:!0});if(n.data){const r=o.headings.map(c=>c.data?String(c.data):c.text);o.data=n.data.map(c=>{let m,f;return Array.isArray(c)?(m={},f=c):c.hasOwnProperty("cells")&&Object.keys(c).every(p=>["cells","attributes"].includes(p))?(m=c.attributes,f=c.cells):(m={},f=[],Object.entries(c).forEach(([p,u])=>{const h=r.indexOf(p);h>-1&&(f[h]=u)})),{attributes:m,cells:f.map((p,u)=>ne(p,t[u]))}})}else(l=e==null?void 0:e.tBodies)!=null&&l.length&&(o.data=Array.from(e.tBodies[0].rows).map(r=>({attributes:Oe(r.attributes),cells:Array.from(r.cells).map((c,m)=>{const f=c.dataset.content?ne(c.dataset.content,t[m]):((p,u)=>{let h;switch(u.type){case"string":h={data:p.innerText};break;case"date":{const v=p.innerText;h={data:v,order:ke(v,u.format)};break}case"number":{const v=parseFloat(p.innerText);h={data:v,order:v,text:p.innerText};break}case"boolean":{const v=!["false","0","null","undefined"].includes(p.innerText.toLowerCase().trim());h={data:v,text:v?"1":"0",order:v?1:0};break}default:h={data:te(p,{valueDiffing:!1}).childNodes||[],text:p.innerText,order:p.innerText}}return h.attributes=Oe(p.attributes),h})(c,t[m]);return c.dataset.order&&(f.order=isNaN(parseFloat(c.dataset.order))?c.dataset.order:parseFloat(c.dataset.order)),f})})));if(o.data.length&&o.data[0].cells.length!==o.headings.length)throw new Error("Data heading length mismatch.");return o};class Ge{constructor(e){S(this,"cursor");S(this,"dt");this.dt=e,this.cursor=!1}setCursor(e=!1){if(e===this.cursor)return;const t=this.cursor;if(this.cursor=e,this.dt._renderTable(),e!==!1&&this.dt.options.scrollY){const s=ee(this.dt.options.classes.cursor),i=this.dt.dom.querySelector(`tr${s}`);i&&i.scrollIntoView({block:"nearest"})}this.dt.emit("datatable.cursormove",this.cursor,t)}add(e){if(!Array.isArray(e)||e.length<1)return;const t={cells:e.map((s,i)=>{const o=this.dt.columns.settings[i];return ne(s,o)})};this.dt.data.data.push(t),this.dt.hasRows=!0,this.dt.update(!0)}remove(e){if(!Array.isArray(e))return this.remove([e]);this.dt.data.data=this.dt.data.data.filter((t,s)=>!e.includes(s)),this.dt.data.data.length||(this.dt.hasRows=!1),this.dt.update(!0)}findRowIndex(e,t){return this.dt.data.data.findIndex(s=>{const i=s.cells[e];return ie(i).toLowerCase().includes(String(t).toLowerCase())})}findRow(e,t){const s=this.findRowIndex(e,t);if(s<0)return{index:-1,row:null,cols:[]};const i=this.dt.data.data[s],o=i.cells.map(a=>a.data);return{index:s,row:i,cols:o}}updateRow(e,t){const s={cells:t.map((i,o)=>{const a=this.dt.columns.settings[o];return ne(i,a)})};this.dt.data.data.splice(e,1,s),this.dt.update(!0)}}class Xe{constructor(e){S(this,"dt");S(this,"settings");S(this,"_state");this.dt=e,this.init()}init(){[this.settings,this._state]=((e=[],t,s)=>{let i=[],o=!1;const a=[];return e.forEach(l=>{(Array.isArray(l.select)?l.select:[l.select]).forEach(r=>{i[r]?l.type&&(i[r].type=l.type):i[r]={type:l.type||t,sortable:!0,searchable:!0};const c=i[r];l.render&&(c.render=l.render),l.format?c.format=l.format:l.type==="date"&&(c.format=s),l.cellClass&&(c.cellClass=l.cellClass),l.headerClass&&(c.headerClass=l.headerClass),l.locale&&(c.locale=l.locale),l.sortable===!1?c.sortable=!1:(l.numeric&&(c.numeric=l.numeric),l.caseFirst&&(c.caseFirst=l.caseFirst)),l.searchable===!1?c.searchable=!1:l.sensitivity&&(c.sensitivity=l.sensitivity),(c.searchable||c.sortable)&&l.ignorePunctuation!==void 0&&(c.ignorePunctuation=l.ignorePunctuation),l.searchMethod&&(c.searchMethod=l.searchMethod),l.hidden&&(c.hidden=!0),l.filter&&(c.filter=l.filter),l.sortSequence&&(c.sortSequence=l.sortSequence),l.sort&&(l.filter?a[r]=l.sort:o={column:r,dir:l.sort}),l.searchItemSeparator!==void 0&&(c.searchItemSeparator=l.searchItemSeparator)})}),i=i.map(l=>l||{type:t,format:t==="date"?s:void 0,sortable:!0,searchable:!0}),[i,{filters:a,sort:o,widths:[]}]})(this.dt.options.columns,this.dt.options.type,this.dt.options.format)}get(e){return e<0||e>=this.size()?null:{...this.settings[e]}}size(){return this.settings.length}swap(e){if(e.length===2){const t=this.dt.data.headings.map((a,l)=>l),s=e[0],i=e[1],o=t[i];return t[i]=t[s],t[s]=o,this.order(t)}}order(e){this.dt.data.headings=e.map(t=>this.dt.data.headings[t]),this.dt.data.data.forEach(t=>t.cells=e.map(s=>t.cells[s])),this.settings=e.map(t=>this.settings[t]),this.dt.update()}hide(e){Array.isArray(e)||(e=[e]),e.length&&(e.forEach(t=>{this.settings[t]||(this.settings[t]={type:"string"}),this.settings[t].hidden=!0}),this.dt.update())}show(e){Array.isArray(e)||(e=[e]),e.length&&(e.forEach(t=>{this.settings[t]||(this.settings[t]={type:"string",sortable:!0}),delete this.settings[t].hidden}),this.dt.update())}visible(e){var t;return e===void 0&&(e=[...Array(this.dt.data.headings.length).keys()]),Array.isArray(e)?e.map(s=>{var i;return!((i=this.settings[s])!=null&&i.hidden)}):!((t=this.settings[e])!=null&&t.hidden)}add(e){const t=this.dt.data.headings.length;if(this.dt.data.headings=this.dt.data.headings.concat([re(e.heading)]),this.dt.data.data.forEach((s,i)=>{s.cells=s.cells.concat([ne(e.data[i],e)])}),this.settings[t]={type:e.type||"string",sortable:!0,searchable:!0},e.type||e.format||e.sortable||e.render||e.filter){const s=this.settings[t];e.render&&(s.render=e.render),e.format&&(s.format=e.format),e.cellClass&&(s.cellClass=e.cellClass),e.headerClass&&(s.headerClass=e.headerClass),e.locale&&(s.locale=e.locale),e.sortable===!1?s.sortable=!1:(e.numeric&&(s.numeric=e.numeric),e.caseFirst&&(s.caseFirst=e.caseFirst)),e.searchable===!1?s.searchable=!1:e.sensitivity&&(s.sensitivity=e.sensitivity),(s.searchable||s.sortable)&&e.ignorePunctuation&&(s.ignorePunctuation=e.ignorePunctuation),e.hidden&&(s.hidden=!0),e.filter&&(s.filter=e.filter),e.sortSequence&&(s.sortSequence=e.sortSequence)}this.dt.update(!0)}remove(e){Array.isArray(e)||(e=[e]),this.dt.data.headings=this.dt.data.headings.filter((t,s)=>!e.includes(s)),this.dt.data.data.forEach(t=>t.cells=t.cells.filter((s,i)=>!e.includes(i))),this.dt.update(!0)}filter(e,t=!1){var o,a;if(!((a=(o=this.settings[e])==null?void 0:o.filter)!=null&&a.length))return;const s=this._state.filters[e];let i;if(s){let l=!1;i=this.settings[e].filter.find(r=>!!l||(r===s&&(l=!0),!1))}else{const l=this.settings[e].filter;i=l?l[0]:void 0}i?this._state.filters[e]=i:s&&(this._state.filters[e]=void 0),this.dt._currentPage=1,this.dt.update(),t||this.dt.emit("datatable.filter",e,i)}sort(e,t=void 0,s=!1){var a;const i=this.settings[e];if(s||this.dt.emit("datatable.sorting",e,t),!t){const l=!(!this._state.sort||this._state.sort.column!==e)&&((a=this._state.sort)==null?void 0:a.dir),r=(i==null?void 0:i.sortSequence)||["asc","desc"];if(l){const c=r.indexOf(l);t=c===-1?r[0]||"asc":c===r.length-1?r[0]:r[c+1]}else t=r.length?r[0]:"asc"}const o=!!["string","html"].includes(i.type)&&new Intl.Collator(i.locale||this.dt.options.locale,{usage:"sort",numeric:i.numeric||this.dt.options.numeric,caseFirst:i.caseFirst||this.dt.options.caseFirst,ignorePunctuation:i.ignorePunctuation||this.dt.options.ignorePunctuation});this.dt.data.data.sort((l,r)=>{var u,h;const c=l.cells[e],m=r.cells[e];let f=(u=c.order)!=null?u:ie(c),p=(h=m.order)!=null?h:ie(m);if(t==="desc"){const v=f;f=p,p=v}return o&&typeof f!="number"&&typeof p!="number"?o.compare(String(f),String(p)):f<p?-1:f>p?1:0}),this._state.sort={column:e,dir:t},this.dt._searchQueries.length?(this.dt.multiSearch(this.dt._searchQueries),this.dt.emit("datatable.sort",e,t)):s||(this.dt._currentPage=1,this.dt.update(),this.dt.emit("datatable.sort",e,t))}_measureWidths(){var t,s,i,o;const e=this.dt.data.headings.filter((a,l)=>{var r;return!((r=this.settings[l])!=null&&r.hidden)});if((this.dt.options.scrollY.length||this.dt.options.fixedColumns)&&(e==null?void 0:e.length)){this._state.widths=[];const a={noPaging:!0};if(this.dt.options.header||this.dt.options.footer){this.dt.options.scrollY.length&&(a.unhideHeader=!0),this.dt.headerDOM&&this.dt.headerDOM.parentElement.removeChild(this.dt.headerDOM),a.noColumnWidths=!0,this.dt._renderTable(a);const l=Array.from(((s=(t=this.dt.dom.querySelector("thead, tfoot"))==null?void 0:t.firstElementChild)==null?void 0:s.querySelectorAll("th"))||[]);let r=0;const c=this.dt.data.headings.map((f,p)=>{var h;if((h=this.settings[p])!=null&&h.hidden)return 0;const u=l[r].offsetWidth;return r+=1,u}),m=c.reduce((f,p)=>f+p,0);this._state.widths=c.map(f=>f/m*100)}else{a.renderHeader=!0,this.dt._renderTable(a);const l=Array.from(((o=(i=this.dt.dom.querySelector("thead, tfoot"))==null?void 0:i.firstElementChild)==null?void 0:o.querySelectorAll("th"))||[]);let r=0;const c=this.dt.data.headings.map((f,p)=>{var h;if((h=this.settings[p])!=null&&h.hidden)return 0;const u=l[r].offsetWidth;return r+=1,u}),m=c.reduce((f,p)=>f+p,0);this._state.widths=c.map(f=>f/m*100)}this.dt._renderTable()}}}const ce={sortable:!0,locale:"en",numeric:!0,caseFirst:"false",searchable:!0,sensitivity:"base",ignorePunctuation:!0,destroyable:!0,searchItemSeparator:"",searchQuerySeparator:" ",searchAnd:!1,searchMethod:!1,data:{},type:"html",format:"YYYY-MM-DD",columns:[],paging:!0,perPage:10,perPageSelect:[5,10,15,20,25],nextPrev:!0,firstLast:!1,prevText:"\u2039",nextText:"\u203A",firstText:"\xAB",lastText:"\xBB",ellipsisText:"\u2026",truncatePager:!0,pagerDelta:2,scrollY:"",fixedColumns:!0,fixedHeight:!1,footer:!1,header:!0,hiddenHeader:!1,caption:void 0,rowNavigation:!1,rowSelectionKeys:["Enter"," "],tabIndex:!1,pagerRender:!1,rowRender:!1,tableRender:!1,diffDomOptions:{valueDiffing:!1},labels:{placeholder:"Search...",searchTitle:"Search within table",perPage:"entries per page",pageTitle:"Page {page}",noRows:"No entries found",noResults:"No results match your search query",info:"Showing {start} to {end} of {rows} entries"},template:(n,e)=>`<div class='${n.classes.top}'>
    ${n.paging&&n.perPageSelect?`<div class='${n.classes.dropdown}'>
            <label>
                <select class='${n.classes.selector}' name="per-page"></select> ${n.labels.perPage}
            </label>
        </div>`:""}
    ${n.searchable?`<div class='${n.classes.search}'>
            <input class='${n.classes.input}' placeholder='${n.labels.placeholder}' type='search' name="search" title='${n.labels.searchTitle}'${e.id?` aria-controls="${e.id}"`:""}>
        </div>`:""}
</div>
<div class='${n.classes.container}'${n.scrollY.length?` style='height: ${n.scrollY}; overflow-Y: auto;'`:""}></div>
<div class='${n.classes.bottom}'>
    ${n.paging?`<div class='${n.classes.info}'></div>`:""}
    <nav class='${n.classes.pagination}'></nav>
</div>`,classes:{active:"datatable-active",ascending:"datatable-ascending",bottom:"datatable-bottom",container:"datatable-container",cursor:"datatable-cursor",descending:"datatable-descending",disabled:"datatable-disabled",dropdown:"datatable-dropdown",ellipsis:"datatable-ellipsis",filter:"datatable-filter",filterActive:"datatable-filter-active",empty:"datatable-empty",headercontainer:"datatable-headercontainer",hidden:"datatable-hidden",info:"datatable-info",input:"datatable-input",loading:"datatable-loading",pagination:"datatable-pagination",paginationList:"datatable-pagination-list",paginationListItem:"datatable-pagination-list-item",paginationListItemLink:"datatable-pagination-list-item-link",search:"datatable-search",selector:"datatable-selector",sorter:"datatable-sorter",table:"datatable-table",top:"datatable-top",wrapper:"datatable-wrapper"}},ae=(n,e,t,s={})=>({nodeName:"LI",attributes:{class:s.active&&!s.hidden?`${t.classes.paginationListItem} ${t.classes.active}`:s.hidden?`${t.classes.paginationListItem} ${t.classes.hidden} ${t.classes.disabled}`:t.classes.paginationListItem},childNodes:[{nodeName:"BUTTON",attributes:{"data-page":String(n),class:t.classes.paginationListItemLink,"aria-label":t.labels.pageTitle.replace("{page}",String(n))},childNodes:[{nodeName:"#text",data:e}]}]}),Ke=(n,e,t,s,i)=>{let o=[];if(i.firstLast&&o.push(ae(1,i.firstText,i)),i.nextPrev){const l=n?1:t-1;o.push(ae(l,i.prevText,i,{hidden:n}))}let a=[...Array(s).keys()].map(l=>ae(l+1,String(l+1),i,{active:l===t-1}));if(i.truncatePager&&(a=((l,r,c,m)=>{const f=m.pagerDelta,p=m.classes,u=m.ellipsisText,h=2*f;let v=r-f,D=r+f;r<4-f+h?D=3+h:r>c-(3-f+h)&&(v=c-(2+h));const M=[];for(let L=1;L<=c;L++)if(L==1||L==c||L>=v&&L<=D){const A=l[L-1];M.push(A)}let d;const y=[];return M.forEach(L=>{const A=parseInt(L.childNodes[0].attributes["data-page"],10);if(d){const T=parseInt(d.childNodes[0].attributes["data-page"],10);if(A-T==2)y.push(l[T]);else if(A-T!=1){const k={nodeName:"LI",attributes:{class:`${p.paginationListItem} ${p.ellipsis} ${p.disabled}`},childNodes:[{nodeName:"BUTTON",attributes:{class:p.paginationListItemLink},childNodes:[{nodeName:"#text",data:u}]}]};y.push(k)}}y.push(L),d=L}),y})(a,t,s,i)),o=o.concat(a),i.nextPrev){const l=e?s:t+1;o.push(ae(l,i.nextText,i,{hidden:e}))}return i.firstLast&&o.push(ae(s,i.lastText,i)),{nodeName:"UL",attributes:{class:i.classes.paginationList},childNodes:a.length>1?o:[]}};class st{constructor(e,t={}){S(this,"columns");S(this,"containerDOM");S(this,"_currentPage");S(this,"data");S(this,"_dd");S(this,"dom");S(this,"_events");S(this,"hasHeadings");S(this,"hasRows");S(this,"headerDOM");S(this,"_initialHTML");S(this,"initialized");S(this,"_label");S(this,"lastPage");S(this,"_listeners");S(this,"onFirstPage");S(this,"onLastPage");S(this,"options");S(this,"_pagerDOMs");S(this,"_virtualPagerDOM");S(this,"pages");S(this,"_rect");S(this,"rows");S(this,"_searchData");S(this,"_searchQueries");S(this,"_tableAttributes");S(this,"_tableFooters");S(this,"_tableCaptions");S(this,"totalPages");S(this,"_virtualDOM");S(this,"_virtualHeaderDOM");S(this,"wrapperDOM");S(this,"_onResize",Ie(()=>{this._rect=this.containerDOM.getBoundingClientRect(),this._rect.width&&this.update(!0)},250));const s=typeof e=="string"?document.querySelector(e):e;s instanceof HTMLTableElement?this.dom=s:(this.dom=document.createElement("table"),s.appendChild(this.dom));const i={...ce.diffDomOptions,...t.diffDomOptions},o={...ce.labels,...t.labels},a={...ce.classes,...t.classes};this.options={...ce,...t,diffDomOptions:i,labels:o,classes:a},this._initialHTML=this.options.destroyable?s.outerHTML:"",this.options.tabIndex?this.dom.tabIndex=this.options.tabIndex:this.options.rowNavigation&&this.dom.tabIndex===-1&&(this.dom.tabIndex=0),this._listeners={onResize:()=>this._onResize()},this._dd=new Qe(this.options.diffDomOptions||{}),this.initialized=!1,this._events={},this._currentPage=0,this.onFirstPage=!0,this.hasHeadings=!1,this.hasRows=!1,this._searchQueries=[],this.init()}init(){var e,t,s,i;if(this.initialized||me(this.dom,this.options.classes.table))return!1;this._virtualDOM=te(this.dom,this.options.diffDomOptions||{}),this._tableAttributes={...this._virtualDOM.attributes},this._tableFooters=(t=(e=this._virtualDOM.childNodes)==null?void 0:e.filter(o=>o.nodeName==="TFOOT"))!=null?t:[],this._tableCaptions=(i=(s=this._virtualDOM.childNodes)==null?void 0:s.filter(o=>o.nodeName==="CAPTION"))!=null?i:[],this.options.caption!==void 0&&this._tableCaptions.push({nodeName:"CAPTION",childNodes:[{nodeName:"#text",data:this.options.caption}]}),this.rows=new Ge(this),this.columns=new Xe(this),this.data=Ae(this.options.data,this.dom,this.columns.settings,this.options.type,this.options.format),this._render(),setTimeout(()=>{this.emit("datatable.init"),this.initialized=!0},10)}_render(){this.wrapperDOM=fe("div",{class:`${this.options.classes.wrapper} ${this.options.classes.loading}`}),this.wrapperDOM.innerHTML=this.options.template(this.options,this.dom);const e=ee(this.options.classes.selector),t=this.wrapperDOM.querySelector(`select${e}`);t&&this.options.paging&&this.options.perPageSelect?this.options.perPageSelect.forEach(a=>{const[l,r]=Array.isArray(a)?[a[0],a[1]]:[String(a),a],c=r===this.options.perPage,m=new Option(l,String(r),c,c);t.appendChild(m)}):t&&t.parentElement.removeChild(t);const s=ee(this.options.classes.container);this.containerDOM=this.wrapperDOM.querySelector(s),this._pagerDOMs=[];const i=ee(this.options.classes.pagination);Array.from(this.wrapperDOM.querySelectorAll(i)).forEach(a=>{a instanceof HTMLElement&&(a.innerHTML=`<ul class="${this.options.classes.paginationList}"></ul>`,this._pagerDOMs.push(a.firstElementChild))}),this._virtualPagerDOM={nodeName:"UL",attributes:{class:this.options.classes.paginationList}};const o=ee(this.options.classes.info);this._label=this.wrapperDOM.querySelector(o),this.dom.parentElement.replaceChild(this.wrapperDOM,this.dom),this.containerDOM.appendChild(this.dom),this._rect=this.dom.getBoundingClientRect(),this._fixHeight(),this.options.header||this.wrapperDOM.classList.add("no-header"),this.options.footer||this.wrapperDOM.classList.add("no-footer"),this.options.sortable&&this.wrapperDOM.classList.add("sortable"),this.options.searchable&&this.wrapperDOM.classList.add("searchable"),this.options.fixedHeight&&this.wrapperDOM.classList.add("fixed-height"),this.options.fixedColumns&&this.wrapperDOM.classList.add("fixed-columns"),this._bindEvents(),this.columns._state.sort&&this.columns.sort(this.columns._state.sort.column,this.columns._state.sort.dir,!0),this.update(!0)}_renderTable(e={}){let t;t=(this.options.paging||this._searchQueries.length||this.columns._state.filters.length)&&this._currentPage&&this.pages.length&&!e.noPaging?this.pages[this._currentPage-1]:this.data.data.map((o,a)=>({row:o,index:a}));let s=Se(this._tableAttributes,this.data.headings,t,this.columns.settings,this.columns._state,this.rows.cursor,this.options,e,this._tableFooters,this._tableCaptions);if(this.options.tableRender){const o=this.options.tableRender(this.data,s,"main");o&&(s=o)}const i=this._dd.diff(this._virtualDOM,s);this._dd.apply(this.dom,i),this._virtualDOM=s}_renderPage(e=!1){this.hasRows&&this.totalPages?(this._currentPage>this.totalPages&&(this._currentPage=1),this._renderTable(),this.onFirstPage=this._currentPage===1,this.onLastPage=this._currentPage===this.lastPage):this.setMessage(this.options.labels.noRows);let t,s=0,i=0,o=0;if(this.totalPages&&(s=this._currentPage-1,i=s*this.options.perPage,o=i+this.pages[s].length,i+=1,t=this._searchQueries.length?this._searchData.length:this.data.data.length),this._label&&this.options.labels.info.length){const a=this.options.labels.info.replace("{start}",String(i)).replace("{end}",String(o)).replace("{page}",String(this._currentPage)).replace("{pages}",String(this.totalPages)).replace("{rows}",String(t));this._label.innerHTML=t?a:""}if(this._currentPage==1&&this._fixHeight(),this.options.rowNavigation&&this._currentPage&&(!this.rows.cursor||!this.pages[this._currentPage-1].find(a=>a.index===this.rows.cursor))){const a=this.pages[this._currentPage-1];a.length&&(e?this.rows.setCursor(a[a.length-1].index):this.rows.setCursor(a[0].index))}}_renderPagers(){if(!this.options.paging)return;let e=Ke(this.onFirstPage,this.onLastPage,this._currentPage,this.totalPages,this.options);if(this.options.pagerRender){const s=this.options.pagerRender([this.onFirstPage,this.onLastPage,this._currentPage,this.totalPages],e);s&&(e=s)}const t=this._dd.diff(this._virtualPagerDOM,e);this._pagerDOMs.forEach(s=>{this._dd.apply(s,t)}),this._virtualPagerDOM=e}_renderSeparateHeader(){const e=this.dom.parentElement;this.headerDOM||(this.headerDOM=document.createElement("div"),this._virtualHeaderDOM={nodeName:"DIV"}),e.parentElement.insertBefore(this.headerDOM,e);let t={nodeName:"TABLE",attributes:this._tableAttributes,childNodes:[{nodeName:"THEAD",childNodes:[De(this.data.headings,this.columns.settings,this.columns._state,this.options,{unhideHeader:!0})]}]};if(t.attributes.class=U(t.attributes.class,this.options.classes.table),this.options.tableRender){const a=this.options.tableRender(this.data,t,"header");a&&(t=a)}const s={nodeName:"DIV",attributes:{class:this.options.classes.headercontainer},childNodes:[t]},i=this._dd.diff(this._virtualHeaderDOM,s);this._dd.apply(this.headerDOM,i),this._virtualHeaderDOM=s;const o=this.headerDOM.firstElementChild.clientWidth-this.dom.clientWidth;if(o){const a=structuredClone(this._virtualHeaderDOM);a.attributes.style=`padding-right: ${o}px;`;const l=this._dd.diff(this._virtualHeaderDOM,a);this._dd.apply(this.headerDOM,l),this._virtualHeaderDOM=a}e.scrollHeight>e.clientHeight&&(e.style.overflowY="scroll")}_bindEvents(){if(this.options.perPageSelect){const e=ee(this.options.classes.selector),t=this.wrapperDOM.querySelector(e);t&&t instanceof HTMLSelectElement&&t.addEventListener("change",()=>{this.emit("datatable.perpage:before",this.options.perPage),this.options.perPage=parseInt(t.value,10),this.update(),this._fixHeight(),this.emit("datatable.perpage",this.options.perPage)},!1)}this.options.searchable&&this.wrapperDOM.addEventListener("input",e=>{const t=ee(this.options.classes.input),s=e.target;if(!(s instanceof HTMLInputElement&&s.matches(t)))return;e.preventDefault();const i=[];if(Array.from(this.wrapperDOM.querySelectorAll(t)).filter(o=>o.value.length).forEach(o=>{const a=o.dataset.and||this.options.searchAnd,l=o.dataset.querySeparator||this.options.searchQuerySeparator?o.value.split(this.options.searchQuerySeparator):[o.value];a?l.forEach(r=>{o.dataset.columns?i.push({terms:[r],columns:JSON.parse(o.dataset.columns)}):i.push({terms:[r],columns:void 0})}):o.dataset.columns?i.push({terms:l,columns:JSON.parse(o.dataset.columns)}):i.push({terms:l,columns:void 0})}),i.length===1&&i[0].terms.length===1){const o=i[0];this.search(o.terms[0],o.columns)}else this.multiSearch(i)}),this.wrapperDOM.addEventListener("click",e=>{const t=e.target.closest("a, button");if(t){if(t.hasAttribute("data-page"))this.page(parseInt(t.getAttribute("data-page"),10)),e.preventDefault();else if(me(t,this.options.classes.sorter)){const s=Array.from(t.parentElement.parentElement.children).indexOf(t.parentElement),i=Me(s,this.columns.settings);this.columns.sort(i),e.preventDefault()}else if(me(t,this.options.classes.filter)){const s=Array.from(t.parentElement.parentElement.children).indexOf(t.parentElement),i=Me(s,this.columns.settings);this.columns.filter(i),e.preventDefault()}}},!1),this.options.rowNavigation&&this.dom.addEventListener("keydown",e=>{if(e.key==="ArrowUp"){let t;e.preventDefault(),e.stopPropagation(),this.pages[this._currentPage-1].find(s=>s.index===this.rows.cursor||(t=s,!1)),t?this.rows.setCursor(t.index):this.onFirstPage||this.page(this._currentPage-1,!0)}else if(e.key==="ArrowDown"){let t;e.preventDefault(),e.stopPropagation();const s=this.pages[this._currentPage-1].find(i=>!!t||(i.index===this.rows.cursor&&(t=!0),!1));s?this.rows.setCursor(s.index):this.onLastPage||this.page(this._currentPage+1)}else this.options.rowSelectionKeys.includes(e.key)&&this.emit("datatable.selectrow",this.rows.cursor,e,!0)}),this.dom.addEventListener("mousedown",e=>{const t=e.target;if(!(t instanceof Element))return;const s=Array.from(this.dom.querySelectorAll("tbody > tr")).find(i=>i.contains(t));s&&s instanceof HTMLElement&&this.emit("datatable.selectrow",parseInt(s.dataset.index,10),e,this.dom.matches(":focus"))}),window.addEventListener("resize",this._listeners.onResize)}destroy(){var e;if(this.options.destroyable){if(this.wrapperDOM){const t=this.wrapperDOM.parentElement;if(t){const s=fe("div");s.innerHTML=this._initialHTML;const i=s.firstElementChild;t.replaceChild(i,this.wrapperDOM),this.dom=i}else(e=this.options.classes.table)==null||e.split(" ").forEach(s=>this.wrapperDOM.classList.remove(s))}window.removeEventListener("resize",this._listeners.onResize),this.initialized=!1}}update(e=!1){var t;this.emit("datatable.update:before"),e&&(this.columns._measureWidths(),this.hasRows=Boolean(this.data.data.length),this.hasHeadings=Boolean(this.data.headings.length)),(t=this.options.classes.empty)==null||t.split(" ").forEach(s=>this.wrapperDOM.classList.remove(s)),this._paginate(),this._renderPage(),this._renderPagers(),this.options.scrollY.length&&this._renderSeparateHeader(),this.emit("datatable.update")}_paginate(){let e=this.data.data.map((t,s)=>({row:t,index:s}));return this._searchQueries.length&&(e=[],this._searchData.forEach(t=>e.push({index:t,row:this.data.data[t]}))),this.columns._state.filters.length&&this.columns._state.filters.forEach((t,s)=>{t&&(e=e.filter(i=>{const o=i.row.cells[s];return typeof t=="function"?t(o.data):ie(o)===t}))}),this.options.paging&&this.options.perPage>0?this.pages=e.map((t,s)=>s%this.options.perPage==0?e.slice(s,s+this.options.perPage):null).filter(t=>t):this.pages=[e],this.totalPages=this.lastPage=this.pages.length,this._currentPage||(this._currentPage=1),this.totalPages}_fixHeight(){this.options.fixedHeight&&(this.containerDOM.style.height=null,this._rect=this.containerDOM.getBoundingClientRect(),this.containerDOM.style.height=`${this._rect.height}px`)}search(e,t=void 0,s="search"){if(this.emit("datatable.search:before",e,this._searchData),!e.length)return this._currentPage=1,this._searchQueries=[],this._searchData=[],this.update(),this.emit("datatable.search","",[]),this.wrapperDOM.classList.remove("search-results"),!1;this.multiSearch([{terms:[e],columns:t||void 0}],s),this.emit("datatable.search",e,this._searchData)}multiSearch(e,t="search"){if(!this.hasRows)return!1;this._currentPage=1,this._searchData=[];let s=e.map(o=>({columns:o.columns,terms:o.terms.map(a=>a.trim()).filter(a=>a),source:t})).filter(o=>o.terms.length);if(this.emit("datatable.multisearch:before",s,this._searchData),t.length&&(s=s.concat(this._searchQueries.filter(o=>o.source!==t))),this._searchQueries=s,!s.length)return this.update(),this.emit("datatable.multisearch",s,this._searchData),this.wrapperDOM.classList.remove("search-results"),!1;const i=s.map(o=>this.columns.settings.map((a,l)=>{var m;if(a.hidden||!a.searchable||o.columns&&!o.columns.includes(l))return!1;let r=o.terms;const c=a.sensitivity||this.options.sensitivity;return["base","accent"].includes(c)&&(r=r.map(f=>f.toLowerCase())),["base","case"].includes(c)&&(r=r.map(f=>f.normalize("NFD").replace(/\p{Diacritic}/gu,""))),((m=a.ignorePunctuation)!=null?m:this.options.ignorePunctuation)&&(r=r.map(f=>f.replace(/[.,/#!$%^&*;:{}=-_`~()]/g,""))),r}));this.data.data.forEach((o,a)=>{const l=o.cells.map((r,c)=>{var u;const m=this.columns.settings[c];if(m.searchMethod||this.options.searchMethod)return r;let f=ie(r).trim();if(f.length){const h=m.sensitivity||this.options.sensitivity;["base","accent"].includes(h)&&(f=f.toLowerCase()),["base","case"].includes(h)&&(f=f.normalize("NFD").replace(/\p{Diacritic}/gu,"")),((u=m.ignorePunctuation)!=null?u:this.options.ignorePunctuation)&&(f=f.replace(/[.,/#!$%^&*;:{}=-_`~()]/g,""))}const p=m.searchItemSeparator||this.options.searchItemSeparator;return p?f.split(p):[f]});i.every((r,c)=>r.find((m,f)=>{if(!m)return!1;const p=this.columns.settings[f].searchMethod||this.options.searchMethod;return p?p(m,l[f],o,f,s[c].source):m.find(u=>l[f].find(h=>h.includes(u)))}))&&this._searchData.push(a)}),this.wrapperDOM.classList.add("search-results"),this._searchData.length?this.update():(this.wrapperDOM.classList.remove("search-results"),this.setMessage(this.options.labels.noResults)),this.emit("datatable.multisearch",s,this._searchData)}page(e,t=!1){return this.emit("datatable.page:before",e),e!==this._currentPage&&(isNaN(e)||(this._currentPage=e),!(e>this.pages.length||e<0)&&(this._renderPage(t),this._renderPagers(),void this.emit("datatable.page",e)))}insert(e){let t=[];if(Array.isArray(e)){const s=this.data.headings.map(i=>i.data?String(i.data):i.text);e.forEach((i,o)=>{const a=[];Object.entries(i).forEach(([l,r])=>{const c=s.indexOf(l);c>-1?a[c]=ne(r,this.columns.settings[c]):this.hasHeadings||this.hasRows||o!==0||(a[s.length]=ne(r,this.columns.settings[s.length]),s.push(l),this.data.headings.push(re(l)))}),t.push({cells:a})})}else Ye(e)&&(!e.headings||this.hasHeadings||this.hasRows?e.data&&Array.isArray(e.data)&&(t=e.data.map(s=>{let i,o;return Array.isArray(s)?(i={},o=s):(i=s.attributes,o=s.cells),{attributes:i,cells:o.map((a,l)=>ne(a,this.columns.settings[l]))}})):this.data=Ae(e,void 0,this.columns.settings,this.options.type,this.options.format));t.length&&t.forEach(s=>this.data.data.push(s)),this.hasHeadings=Boolean(this.data.headings.length),this.columns._state.sort&&this.columns.sort(this.columns._state.sort.column,this.columns._state.sort.dir,!0),this.update(!0)}refresh(){if(this.emit("datatable.refresh:before"),this.options.searchable){const e=ee(this.options.classes.input);Array.from(this.wrapperDOM.querySelectorAll(e)).forEach(t=>t.value=""),this._searchQueries=[]}this._currentPage=1,this.onFirstPage=!0,this.update(!0),this.emit("datatable.refresh")}print(){const e=fe("table");let t=Se(this._tableAttributes,this.data.headings,this.data.data.map((o,a)=>({row:o,index:a})),this.columns.settings,this.columns._state,!1,this.options,{noColumnWidths:!0,unhideHeader:!0},this._tableFooters,this._tableCaptions);if(this.options.tableRender){const o=this.options.tableRender(this.data,t,"print");o&&(t=o)}const s=this._dd.diff({nodeName:"TABLE"},t);this._dd.apply(e,s);const i=window.open();i.document.body.appendChild(e),i.print()}setMessage(e){var o;const t=this.data.headings.filter((a,l)=>{var r;return!((r=this.columns.settings[l])!=null&&r.hidden)}).length||1;(o=this.options.classes.empty)==null||o.split(" ").forEach(a=>this.wrapperDOM.classList.add(a)),this._label&&(this._label.innerHTML=""),this.totalPages=0,this._renderPagers();let s={nodeName:"TABLE",attributes:this._tableAttributes,childNodes:[{nodeName:"THEAD",childNodes:[De(this.data.headings,this.columns.settings,this.columns._state,this.options,{})]},{nodeName:"TBODY",childNodes:[{nodeName:"TR",childNodes:[{nodeName:"TD",attributes:{class:this.options.classes.empty,colspan:String(t)},childNodes:[{nodeName:"#text",data:e}]}]}]}]};if(this._tableFooters.forEach(a=>s.childNodes.push(a)),this._tableCaptions.forEach(a=>s.childNodes.push(a)),s.attributes.class=U(s.attributes.class,this.options.classes.table),this.options.tableRender){const a=this.options.tableRender(this.data,s,"message");a&&(s=a)}const i=this._dd.diff(this._virtualDOM,s);this._dd.apply(this.dom,i),this._virtualDOM=s}on(e,t){this._events[e]=this._events[e]||[],this._events[e].push(t)}off(e,t){e in this._events&&this._events[e].splice(this._events[e].indexOf(t),1)}emit(e,...t){if(e in this._events)for(let s=0;s<this._events[e].length;s++)this._events[e][s](...t)}}export{st as a};
